# Commit Message Guidelines

This repository is a small Vite plugin. We use Conventional Commits with the angular preset.
This document is a compact guide for humans and for GitHub Copilot so generated
commit messages are consistent and work with the release tooling.

---

## High level

- Use Conventional Commits: <type>(<scope>): <subject>
- Keep subject short (imperative, ideally ≤50 chars, hard limit ~72 chars, no trailing period).
- Write the body in English only when additional context is needed (wrap at ~72 chars).
- Add a footer for breaking changes or issue references (e.g. `Closes: #12`).
- Release commits (chore(release): vX.Y.Z) are generated by the release script — do not create them manually.
- For incompatible changes, always include a `BREAKING CHANGE:` footer. Without this marker,
  the release tool will not trigger a major version bump.

## Commit message format

```conventionalcommit
<type>(<scope>): <subject>

<body - English, wrapped at ~72 chars>

<footer - references, BREAKING CHANGE>
```

- type: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert
- scope: one of the recommended scopes below (or a concise file/area name)

## Choosing the correct type (short)

- feat — new plugin option or new public behavior
- fix — bug fix that affects plugin output or user experience
- refactor — internal code changes without API/behavior changes
- perf — measurable performance improvement
- docs — README or inline docs only
- test — add or change tests
- build — build system or packaging changes (e.g. rollup, vite config)
- ci — CI configuration changes (e.g. GitHub Actions, pipelines)
- chore — housekeeping and maintenance (dependency bumps, repo config, misc tasks)
- revert — revert a previous commit (include reference)

## Recommended scopes for this Vite plugin

Use one of these common scopes to keep the history readable:

- plugin — default scope for user-visible plugin behavior
- transform — Vite `transform()` logic and related helpers
- resolve — Vite `resolveId()` behavior and module resolution
- load — Vite `load()` behavior
- hmr — HMR / `handleHotUpdate` behavior
- options — plugin options schema/validation and defaults
- types — TypeScript types / d.ts surface
- config — repository configuration (tsconfig, eslint, prettier)
- packaging — bundling/distribution setup (rollup config, entry points)
- deps — dependency updates (npm/yarn/pnpm)
- tests — unit/integration tests (vitest)
- ci-config — CI workflows (GitHub Actions)
- readme — docs in README or docs site
- repo — meta/repo housekeeping (issue templates, editorconfig)

If the change touches a single file or narrow area, the scope may be the filename
(e.g. `helpers`, `compiler`, `logger`). Prefer `plugin` for public behavior changes.

## Examples tailored to this project

### Feature (new plugin option)

```conventionalcommit
feat(plugin): add `enforce: 'pre'` option to improve transform ordering

Add `enforce` option to allow consumers to control the plugin order when
multiple plugins run. This is a user-facing feature and affects how files are
transformed.
```

### Fix (bug in transform)

```conventionalcommit
fix(plugin): avoid double-transforming .vue files when hot-reloading

Prevented duplicate transformations during HMR by checking `file.endsWith` and
skipping files already processed.
```

### Docs

```conventionalcommit
docs(readme): document usage example with Vite 5

Add an end-to-end usage snippet showing plugin setup in Vite 5 and minimal
options.
```

### Tests

```conventionalcommit
test(tests): add vitest cases for compiler option `sourceMap`

Add unit tests that cover the `sourceMap` flag behavior and ensure output
matches expectations.
```

### Build

```conventionalcommit
build(packaging): update rollup config to include types in package
```

### Chore

```conventionalcommit
chore(deps): bump typescript to 5.x
```

```conventionalcommit
chore(config): update eslint rules for import order
```

### BREAKING CHANGES

> Always mark incompatible changes with `BREAKING CHANGE:` in the footer.
This ensures `release-it` generates a major version bump and documents it in the changelog.

When a change is incompatible, include a `BREAKING CHANGE:` entry in the footer.
Explain migration steps if applicable. Example:

```conventionalcommit
feat(plugin): rename `oldOption` to `newOption`

BREAKING CHANGE: `oldOption` was removed. Use `newOption` which is a boolean now.
```

## Important notes for GitHub Copilot (and automated assistants)

- Always follow the angular preset format exactly.
- Use `plugin` as the default scope for code that changes the plugin's external
  behavior or options.
- Prefer concise, imperative subjects (e.g. `add`, `fix`, `remove`, `rename`).
- Do not generate release commits: `chore(release): vX.Y.Z` — the release tool
  creates them.
- If the change is only docs or tests, use `docs(...)` or `test(...)` respectively.
- When in doubt, a safe generic commit is `chore: describe change`, but try to
  pick a more specific type and scope.

## Why this matters

Consistent commit messages keep CHANGELOGs clean and make automated releases
and semantic versioning reliable for this plugin project.
